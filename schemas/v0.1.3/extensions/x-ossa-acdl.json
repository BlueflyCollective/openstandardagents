{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://open-standards-scalable-agents.org/schemas/v0.1.3/extensions/x-ossa-acdl.json",
  "title": "OSSA ACDL (Agent Capability Discovery Layer) Extension",
  "description": "Hierarchical capability taxonomy and discovery optimization for OSSA agents",
  "type": "object",
  "properties": {
    "x-ossa-acdl": {
      "type": "object",
      "required": ["capabilityTaxonomy", "discovery", "routing"],
      "properties": {
        "capabilityTaxonomy": {
          "type": "object",
          "required": ["structure", "hierarchy"],
          "properties": {
            "structure": {
              "type": "string",
              "pattern": "^ai-capabilities/[a-z0-9-]+/[a-z0-9-]+$",
              "default": "ai-capabilities/domain/function",
              "description": "Hierarchical capability taxonomy structure"
            },
            "hierarchy": {
              "type": "object",
              "required": ["domains", "functions"],
              "properties": {
                "domains": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["name", "id", "functions"],
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "Domain display name"
                      },
                      "id": {
                        "type": "string",
                        "pattern": "^[a-z0-9-]+$",
                        "description": "Domain identifier"
                      },
                      "description": {
                        "type": "string",
                        "description": "Domain description"
                      },
                      "functions": {
                        "type": "array",
                        "items": {
                          "$ref": "#/properties/x-ossa-acdl/properties/capabilityTaxonomy/properties/hierarchy/properties/functions"
                        }
                      }
                    }
                  }
                },
                "functions": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["name", "id", "capability"],
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "Function display name"
                      },
                      "id": {
                        "type": "string",
                        "pattern": "^[a-z0-9-]+$",
                        "description": "Function identifier"
                      },
                      "capability": {
                        "type": "string",
                        "description": "Capability identifier"
                      },
                      "parameters": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "required": ["name", "type"],
                          "properties": {
                            "name": {
                              "type": "string"
                            },
                            "type": {
                              "type": "string",
                              "enum": ["string", "number", "boolean", "object", "array"]
                            },
                            "required": {
                              "type": "boolean",
                              "default": false
                            },
                            "description": {
                              "type": "string"
                            }
                          }
                        }
                      },
                      "complexity": {
                        "type": "string",
                        "enum": ["low", "medium", "high", "production"],
                        "default": "medium"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "discovery": {
          "type": "object",
          "required": ["enabled", "optimization"],
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true,
              "description": "Enable capability discovery"
            },
            "optimization": {
              "type": "object",
              "required": ["strategy", "targets"],
              "properties": {
                "strategy": {
                  "type": "string",
                  "enum": ["hierarchical", "semantic", "graph", "hybrid"],
                  "default": "hybrid",
                  "description": "Discovery optimization strategy"
                },
                "targets": {
                  "type": "object",
                  "properties": {
                    "latency": {
                      "type": "integer",
                      "minimum": 10,
                      "maximum": 100,
                      "default": 50,
                      "description": "Target discovery latency in milliseconds (<50ms)"
                    },
                    "accuracy": {
                      "type": "number",
                      "minimum": 0.9,
                      "maximum": 1.0,
                      "default": 0.98,
                      "description": "Target discovery accuracy"
                    },
                    "coverage": {
                      "type": "number",
                      "minimum": 0.8,
                      "maximum": 1.0,
                      "default": 0.95,
                      "description": "Capability coverage target"
                    }
                  }
                },
                "caching": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean",
                      "default": true
                    },
                    "ttl": {
                      "type": "integer",
                      "minimum": 60,
                      "maximum": 3600,
                      "default": 300,
                      "description": "Cache TTL in seconds"
                    },
                    "strategy": {
                      "type": "string",
                      "enum": ["lru", "lfu", "ttl", "adaptive"],
                      "default": "adaptive"
                    }
                  }
                }
              }
            },
            "indexing": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "algorithm": {
                  "type": "string",
                  "enum": ["trie", "hash", "btree", "graph"],
                  "default": "graph",
                  "description": "Indexing algorithm for capability lookup"
                },
                "rebuild": {
                  "type": "object",
                  "properties": {
                    "strategy": {
                      "type": "string",
                      "enum": ["on_change", "periodic", "manual"],
                      "default": "on_change"
                    },
                    "interval": {
                      "type": "string",
                      "pattern": "^[0-9]+[smhd]$",
                      "default": "1h",
                      "description": "Rebuild interval for periodic strategy"
                    }
                  }
                }
              }
            }
          }
        },
        "routing": {
          "type": "object",
          "required": ["strategy", "optimization"],
          "properties": {
            "strategy": {
              "type": "string",
              "enum": ["capability_based", "load_balanced", "performance_weighted", "adaptive"],
              "default": "adaptive",
              "description": "Agent capability routing strategy"
            },
            "optimization": {
              "type": "object",
              "properties": {
                "loadBalancing": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean",
                      "default": true
                    },
                    "algorithm": {
                      "type": "string",
                      "enum": ["round_robin", "least_connections", "weighted", "capability_aware"],
                      "default": "capability_aware"
                    },
                    "weights": {
                      "type": "object",
                      "properties": {
                        "performance": {
                          "type": "number",
                          "minimum": 0.0,
                          "maximum": 1.0,
                          "default": 0.4
                        },
                        "availability": {
                          "type": "number",
                          "minimum": 0.0,
                          "maximum": 1.0,
                          "default": 0.3
                        },
                        "capability_match": {
                          "type": "number",
                          "minimum": 0.0,
                          "maximum": 1.0,
                          "default": 0.3
                        }
                      }
                    }
                  }
                },
                "failover": {
                  "type": "object",
                  "properties": {
                    "enabled": {
                      "type": "boolean",
                      "default": true
                    },
                    "strategy": {
                      "type": "string",
                      "enum": ["immediate", "circuit_breaker", "graceful"],
                      "default": "circuit_breaker"
                    },
                    "retryPolicy": {
                      "type": "object",
                      "properties": {
                        "maxRetries": {
                          "type": "integer",
                          "minimum": 0,
                          "maximum": 10,
                          "default": 3
                        },
                        "backoffStrategy": {
                          "type": "string",
                          "enum": ["linear", "exponential", "fixed"],
                          "default": "exponential"
                        },
                        "initialDelay": {
                          "type": "integer",
                          "minimum": 100,
                          "maximum": 10000,
                          "default": 1000,
                          "description": "Initial retry delay in milliseconds"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "performance": {
          "type": "object",
          "properties": {
            "monitoring": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["discovery_latency", "routing_accuracy", "capability_coverage", "cache_hit_rate"]
                  },
                  "default": ["discovery_latency", "routing_accuracy", "capability_coverage"]
                }
              }
            },
            "benchmarking": {
              "type": "object",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "default": true
                },
                "interval": {
                  "type": "string",
                  "pattern": "^[0-9]+[smhd]$",
                  "default": "15m",
                  "description": "Benchmarking interval"
                },
                "scenarios": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "required": ["name", "query_count"],
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "query_count": {
                        "type": "integer",
                        "minimum": 10,
                        "maximum": 10000
                      },
                      "complexity": {
                        "type": "string",
                        "enum": ["simple", "medium", "complex"],
                        "default": "medium"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}