openapi: 3.1.0
info:
  title: CrewAI Agent API
  version: 0.1.0
  description: |
    CrewAI collaborative multi-agent system with hierarchical coordination.
    Supports crew formation, role-based execution, and task delegation.
  contact:
    name: OpenAPI AI Agents Consortium
    url: https://openapi-ai-agents.org
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

x-openapi-ai-agents-standard:
  version: "0.1.0"
  agent_metadata:
    name: "crew-ai-agent"
    framework: "crewai"
    certification_level: "gold"
    compliance_frameworks: ["ISO_42001_2023", "NIST_AI_RMF_1_0", "EU_AI_Act"]
  capabilities:
    - "collaborative_planning"
    - "role_based_execution" 
    - "crew_coordination"
    - "task_delegation"
    - "hierarchical_decision_making"
  protocols: ["openapi", "mcp"]
  token_management:
    provider: "tiktoken"
    encoding: "o200k_base"
    optimization: "aggressive"
    budget_constraints:
      max_tokens_per_request: 100000
      cost_threshold_usd: 50.0

servers:
  - url: https://api.crewai-agent.example.com/v1
    description: Production server
  - url: http://localhost:3000/v1  
    description: Development server

paths:
  /health:
    get:
      operationId: getHealth
      summary: Health check endpoint
      description: Check agent health and readiness status
      responses:
        '200':
          description: Agent is healthy and ready
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthResponse'

  /capabilities:
    get:
      operationId: getCapabilities
      summary: Get agent capabilities
      description: Retrieve list of agent capabilities and protocols
      responses:
        '200':
          description: Agent capabilities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CapabilitiesResponse'

  /crew/create:
    post:
      operationId: createCrew
      summary: Create a new crew
      description: Initialize a crew with specified roles and hierarchy
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCrewRequest'
      responses:
        '201':
          description: Crew created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /crew/{crew_id}/execute:
    post:
      operationId: executeCrew
      summary: Execute crew task
      description: Execute a task using the specified crew
      parameters:
        - name: crew_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Unique crew identifier
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExecuteTaskRequest'
      responses:
        '200':
          description: Task executed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExecutionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /crew/{crew_id}/status:
    get:
      operationId: getCrewStatus
      summary: Get crew status
      description: Retrieve current status of crew and tasks
      parameters:
        - name: crew_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Unique crew identifier
      responses:
        '200':
          description: Crew status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CrewStatusResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

  /agents:
    get:
      operationId: getAgents
      summary: List available agents
      description: Get list of agents available for crew assignment
      responses:
        '200':
          description: List of available agents
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentsListResponse'

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for authentication
    
  schemas:
    HealthResponse:
      type: object
      required:
        - status
        - timestamp
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        version:
          type: string
        capabilities:
          type: array
          items:
            type: string

    CapabilitiesResponse:
      type: object
      required:
        - capabilities
        - protocols
      properties:
        capabilities:
          type: array
          items:
            type: string
        protocols:
          type: array
          items:
            type: string
        framework:
          type: string
        certification_level:
          type: string
          enum: [bronze, silver, gold]

    CreateCrewRequest:
      type: object
      required:
        - name
        - roles
      properties:
        name:
          type: string
          description: Crew name
        description:
          type: string
          description: Crew purpose description
        roles:
          type: array
          items:
            $ref: '#/components/schemas/AgentRole'
        hierarchy:
          type: string
          enum: [flat, hierarchical]
          default: hierarchical
        max_agents:
          type: integer
          minimum: 1
          maximum: 10
          default: 5

    AgentRole:
      type: object
      required:
        - role_name
        - capabilities
      properties:
        role_name:
          type: string
        capabilities:
          type: array
          items:
            type: string
        priority:
          type: integer
          minimum: 1
          maximum: 10
        manager:
          type: boolean
          default: false

    CrewResponse:
      type: object
      required:
        - crew_id
        - name
        - status
        - created_at
      properties:
        crew_id:
          type: string
          format: uuid
        name:
          type: string
        description:
          type: string
        status:
          type: string
          enum: [initialized, active, completed, failed]
        roles:
          type: array
          items:
            $ref: '#/components/schemas/AgentRole'
        created_at:
          type: string
          format: date-time

    ExecuteTaskRequest:
      type: object
      required:
        - task
      properties:
        task:
          type: object
          required:
            - description
          properties:
            description:
              type: string
            requirements:
              type: array
              items:
                type: string
            deadline:
              type: string
              format: date-time
            priority:
              type: string
              enum: [low, medium, high, critical]
              default: medium
        parameters:
          type: object
          additionalProperties: true

    ExecutionResponse:
      type: object
      required:
        - execution_id
        - status
        - started_at
      properties:
        execution_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [running, completed, failed, cancelled]
        started_at:
          type: string
          format: date-time
        completed_at:
          type: string
          format: date-time
        result:
          type: object
          additionalProperties: true
        agent_results:
          type: array
          items:
            $ref: '#/components/schemas/AgentResult'
        token_usage:
          $ref: '#/components/schemas/TokenUsage'

    AgentResult:
      type: object
      required:
        - agent_role
        - status
      properties:
        agent_role:
          type: string
        status:
          type: string
          enum: [completed, failed, skipped]
        result:
          type: object
          additionalProperties: true
        execution_time_ms:
          type: integer
        error_message:
          type: string

    CrewStatusResponse:
      type: object
      required:
        - crew_id
        - status
        - agents_count
      properties:
        crew_id:
          type: string
          format: uuid
        status:
          type: string
          enum: [initialized, active, completed, failed]
        agents_count:
          type: integer
        active_tasks:
          type: integer
        completed_tasks:
          type: integer
        failed_tasks:
          type: integer
        last_activity:
          type: string
          format: date-time

    AgentsListResponse:
      type: object
      required:
        - agents
      properties:
        agents:
          type: array
          items:
            $ref: '#/components/schemas/AgentInfo'

    AgentInfo:
      type: object
      required:
        - agent_id
        - capabilities
        - status
      properties:
        agent_id:
          type: string
        name:
          type: string
        capabilities:
          type: array
          items:
            type: string
        status:
          type: string
          enum: [available, busy, offline]
        specialization:
          type: string

    TokenUsage:
      type: object
      properties:
        total_tokens:
          type: integer
        prompt_tokens:
          type: integer
        completion_tokens:
          type: integer
        cost_usd:
          type: number
          format: float

    Error:
      type: object
      required:
        - error
        - message
      properties:
        error:
          type: string
        message:
          type: string
        details:
          type: object
          additionalProperties: true
        timestamp:
          type: string
          format: date-time

  responses:
    BadRequest:
      description: Bad request
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    
    Unauthorized:
      description: Unauthorized
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

security:
  - ApiKeyAuth: []