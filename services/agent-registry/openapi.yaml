openapi: 3.1.0
info:
  title: Agent Registry API
  version: 1.0.0
  description: Central agent registry service for workspace-wide agent management
  contact:
    name: OpenAPI AI Agents Standard
    url: https://openapi-ai-agents.org
    email: support@openapi-ai-agents.org
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
  x-openapi-ai-agents-standard:
    version: "0.1.0"
    certification_level: "gold"
    compliance_frameworks: ["ISO_42001", "NIST_AI_RMF", "EU_AI_Act"]
  x-agent-metadata:
    class: "registry"
    protocols: ["openapi", "mcp", "uadp", "a2a"]
    capabilities:
      ["agent_registration", "capability_indexing", "health_monitoring"]
    domains: ["registry", "management", "discovery"]
  x-protocol-bridges:
    mcp:
      enabled: true
      latency: "<50ms"
      capabilities: ["tools", "resources", "prompts"]
    a2a:
      enabled: true
      latency: "<35ms"
      capabilities: ["agent_cards", "negotiation"]
    uadp:
      enabled: true
      latency: "<25ms"
      capabilities: ["discovery", "context_sharing"]

servers:
  - url: http://localhost:8081/api/v1
    description: Local development server
  - url: https://registry.openapi-ai-agents.org/api/v1
    description: Production server

paths:
  /agents:
    get:
      operationId: listAgents
      summary: List all registered agents
      description: Retrieve a list of all agents registered in the workspace
      tags:
        - Agents
      parameters:
        - name: status
          in: query
          description: Filter by agent status
          required: false
          schema:
            type: string
            enum: [active, inactive, error]
        - name: compliance_level
          in: query
          description: Filter by compliance level
          required: false
          schema:
            type: string
            enum: [bronze, silver, gold]
        - name: limit
          in: query
          description: Maximum number of agents to return
          required: false
          schema:
            type: integer
            default: 100
        - name: offset
          in: query
          description: Number of agents to skip
          required: false
          schema:
            type: integer
            default: 0
      responses:
        "200":
          description: List of agents
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentListResponse"

    post:
      operationId: registerAgent
      summary: Register a new agent
      description: Register a new agent in the workspace registry
      tags:
        - Agents
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AgentRegistration"
      responses:
        "201":
          description: Agent registered successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentInfo"
        "400":
          description: Invalid registration data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /agents/{agent_id}:
    get:
      operationId: getAgent
      summary: Get agent details
      description: Retrieve detailed information about a specific agent
      tags:
        - Agents
      parameters:
        - name: agent_id
          in: path
          required: true
          description: Unique agent identifier
          schema:
            type: string
      responses:
        "200":
          description: Agent details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentInfo"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    put:
      operationId: updateAgent
      summary: Update agent information
      description: Update agent registration information
      tags:
        - Agents
      parameters:
        - name: agent_id
          in: path
          required: true
          description: Unique agent identifier
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AgentUpdate"
      responses:
        "200":
          description: Agent updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentInfo"
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

    delete:
      operationId: unregisterAgent
      summary: Unregister an agent
      description: Remove an agent from the registry
      tags:
        - Agents
      parameters:
        - name: agent_id
          in: path
          required: true
          description: Unique agent identifier
          schema:
            type: string
      responses:
        "204":
          description: Agent unregistered successfully
        "404":
          description: Agent not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /agents/{agent_id}/health:
    get:
      operationId: getAgentHealth
      summary: Get agent health status
      description: Retrieve current health status of a specific agent
      tags:
        - Health
      parameters:
        - name: agent_id
          in: path
          required: true
          description: Unique agent identifier
          schema:
            type: string
      responses:
        "200":
          description: Agent health status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AgentHealth"

  /capabilities:
    get:
      operationId: getCapabilities
      summary: Get capability index
      description: Retrieve indexed capabilities across all registered agents
      tags:
        - Capabilities
      parameters:
        - name: capability
          in: query
          description: Filter by specific capability
          required: false
          schema:
            type: string
        - name: domain
          in: query
          description: Filter by domain
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Capability index
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CapabilityIndex"

  /search:
    get:
      operationId: searchAgents
      summary: Search agents by criteria
      description: Search for agents based on various criteria
      tags:
        - Search
      parameters:
        - name: q
          in: query
          description: Search query
          required: true
          schema:
            type: string
        - name: filters
          in: query
          description: Additional filters (JSON)
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Search results
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SearchResponse"

  /health:
    get:
      operationId: healthCheck
      summary: Registry health check
      description: Check registry service health and status
      tags:
        - Health
      responses:
        "200":
          description: Registry is healthy
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RegistryHealth"

components:
  schemas:
    AgentRegistration:
      type: object
      required:
        - name
        - project
        - capabilities
        - endpoint
      properties:
        name:
          type: string
          description: Agent name
        project:
          type: string
          description: Project identifier
        capabilities:
          type: array
          items:
            type: string
          description: List of agent capabilities
        endpoint:
          type: string
          format: uri
          description: Agent endpoint URL
        compliance_level:
          type: string
          enum: [bronze, silver, gold]
          default: bronze
        metadata:
          type: object
          description: Additional agent metadata

    AgentUpdate:
      type: object
      properties:
        name:
          type: string
        capabilities:
          type: array
          items:
            type: string
        endpoint:
          type: string
          format: uri
        compliance_level:
          type: string
          enum: [bronze, silver, gold]
        metadata:
          type: object
        status:
          type: string
          enum: [active, inactive, maintenance]

    AgentInfo:
      type: object
      properties:
        id:
          type: string
          description: Unique agent identifier
        name:
          type: string
          description: Agent name
        project:
          type: string
          description: Project identifier
        capabilities:
          type: array
          items:
            type: string
          description: List of agent capabilities
        endpoint:
          type: string
          format: uri
          description: Agent endpoint URL
        compliance_level:
          type: string
          enum: [bronze, silver, gold]
        status:
          type: string
          enum: [active, inactive, error, maintenance]
        registered_at:
          type: string
          format: date-time
        last_updated:
          type: string
          format: date-time
        last_health_check:
          type: string
          format: date-time
        metadata:
          type: object

    AgentListResponse:
      type: object
      properties:
        agents:
          type: array
          items:
            $ref: "#/components/schemas/AgentInfo"
        total_count:
          type: integer
        limit:
          type: integer
        offset:
          type: integer

    AgentHealth:
      type: object
      properties:
        agent_id:
          type: string
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        last_check:
          type: string
          format: date-time
        response_time_ms:
          type: integer
        uptime_percentage:
          type: number
        error_count:
          type: integer

    CapabilityIndex:
      type: object
      properties:
        capabilities:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
        domains:
          type: object
          additionalProperties:
            type: array
            items:
              type: string
        total_agents:
          type: integer
        last_updated:
          type: string
          format: date-time

    SearchResponse:
      type: object
      properties:
        results:
          type: array
          items:
            $ref: "#/components/schemas/AgentInfo"
        total_matches:
          type: integer
        search_time_ms:
          type: integer
        query:
          type: string

    RegistryHealth:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        registered_agents:
          type: integer
        active_agents:
          type: integer
        total_capabilities:
          type: integer
        uptime_seconds:
          type: integer

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
        message:
          type: string
        code:
          type: string
        timestamp:
          type: string
          format: date-time

  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API key for service authentication
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for user authentication

security:
  - ApiKeyAuth: []
  - BearerAuth: []
