ossaVersion: '1.0'
agent:
  id: security-agent
  name: Security Agent
  version: 0.1.9
  description: Security-focused worker agent for authentication, encryption,
    auditing, and compliance
  role: custom
  tags:
    - worker
    - security
    - ossa-platform
  runtime:
    type: docker
    resources:
      cpu: 1
      memory: 2Gi
  capabilities:
    - name: authenticate_request
      description: Authenticate and authorize API requests
      input_schema:
        type: object
        required:
          - credentials
          - resource
        properties:
          credentials:
            type: object
            properties:
              type:
                type: string
                enum:
                  - bearer_token
                  - api_key
                  - certificate
                  - biometric
              token:
                type: string
              metadata:
                type: object
          resource:
            type: object
            properties:
              path:
                type: string
              method:
                type: string
              permissions_required:
                type: array
          context:
            type: object
            properties:
              ip_address:
                type: string
              user_agent:
                type: string
              session_id:
                type: string
      output_schema:
        type: object
        properties:
          authenticated:
            type: boolean
          authorized:
            type: boolean
          user_identity:
            type: object
          permissions:
            type: array
          security_level:
            type: string
          audit_id:
            type: string
      timeout_seconds: 5000
    - name: encrypt_data
      description: Encrypt sensitive data using AES-256 or specified algorithm
      input_schema:
        type: object
        required:
          - data
        properties:
          data:
            type: string
          algorithm:
            type: string
            enum:
              - aes-256-gcm
              - aes-256-cbc
              - rsa-oaep
              - chacha20-poly1305
            default: aes-256-gcm
          keyId:
            type: string
          additionalData:
            type: string
      output_schema:
        type: object
        properties:
          encryptedData:
            type: string
          keyId:
            type: string
          algorithm:
            type: string
          iv:
            type: string
          authTag:
            type: string
      timeout_seconds: 10000
    - name: decrypt_data
      description: Decrypt previously encrypted data
      input_schema:
        type: object
        required:
          - encryptedData
          - keyId
        properties:
          encryptedData:
            type: string
          keyId:
            type: string
          algorithm:
            type: string
          iv:
            type: string
          authTag:
            type: string
          additionalData:
            type: string
      output_schema:
        type: object
        properties:
          data:
            type: string
          verified:
            type: boolean
      timeout_seconds: 10000
    - name: audit_log
      description: Create comprehensive audit log entries
      input_schema:
        type: object
        required:
          - event
          - actor
        properties:
          event:
            type: object
            properties:
              type:
                type: string
              action:
                type: string
              resource:
                type: string
              result:
                type: string
              timestamp:
                type: string
          actor:
            type: object
            properties:
              id:
                type: string
              type:
                type: string
              ip:
                type: string
              session:
                type: string
          metadata:
            type: object
      output_schema:
        type: object
        properties:
          auditId:
            type: string
          logged:
            type: boolean
          compliance_tags:
            type: array
      timeout_seconds: 3000
    - name: scan_vulnerabilities
      description: Scan for security vulnerabilities in code or systems
      input_schema:
        type: object
        required:
          - target
        properties:
          target:
            type: object
            properties:
              type:
                type: string
                enum:
                  - code
                  - container
                  - network
                  - api
              content:
                type: string
              endpoint:
                type: string
          scanOptions:
            type: object
            properties:
              depth:
                type: string
              categories:
                type: array
              excludes:
                type: array
      output_schema:
        type: object
        properties:
          scanId:
            type: string
          vulnerabilities:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                severity:
                  type: string
                category:
                  type: string
                description:
                  type: string
                remediation:
                  type: string
          summary:
            type: object
            properties:
              total:
                type: number
              critical:
                type: number
              high:
                type: number
              medium:
                type: number
              low:
                type: number
      timeout_seconds: 60000
  policies:
    compliance:
      - iso42001
      - iso27001
    audit: true
  integration:
    protocol: http
    endpoints:
      base_url: http://localhost:3000
      health: /health
      metrics: /metrics
    auth:
      type: api-key
  monitoring:
    traces: true
    metrics: true
    logs: true
  metadata:
    author: OSSA Platform Team
    license: Apache-2.0
    repository: https://github.com/ossa/security-agent
