ossaVersion: "1.0"
agent:
  id: ecosystem-cleanup-orchestrator
  name: Ecosystem Cleanup Master Orchestrator
  version: 1.0.0
  description: Master orchestrator that spawns and coordinates specialized agents to clean up 38K+ TypeScript errors, align CI/CD, and validate OSSA compliance across 15 repos
  role: orchestration
  tags:
    [
      "orchestration",
      "automation",
      "ecosystem",
      "cleanup",
      "parallel-execution",
    ]

  runtime:
    type: k8s
    resources:
      cpu: "200m"
      memory: "512Mi"

  capabilities:
    - name: orchestrate_cleanup
      description: Spawn and coordinate cleanup agents across all repos
      input_schema:
        type: object
        properties:
          repos:
            type: array
            items:
              type: object
              properties:
                name:
                  type: string
                ts_errors:
                  type: integer
                eslint_errors:
                  type: integer
                priority:
                  type: string
      output_schema:
        type: object
        properties:
          spawned_agents:
            type: array
          progress:
            type: object

    - name: spawn_typescript_fixers
      description: Spawn typescript-fixer agents for each high-error repo
      input_schema:
        type: object
      output_schema:
        type: object

    - name: spawn_cicd_aligners
      description: Spawn gitlab-ci-optimizer agents for workflow updates
      input_schema:
        type: object
      output_schema:
        type: object

    - name: spawn_ossa_validators
      description: Spawn ossa-compliance-monitor agents for validation
      input_schema:
        type: object
      output_schema:
        type: object

    - name: monitor_progress
      description: Monitor all spawned agents and aggregate results
      input_schema:
        type: object
      output_schema:
        type: object
        properties:
          total_agents:
            type: integer
          completed:
            type: integer
          errors_fixed:
            type: integer
          repos_cleaned:
            type: integer

  monitoring:
    traces: true
    metrics: true
    logs: true

  bridge:
    kagent:
      enabled: true
      agent_type: declarative
      deployment:
        replicas: 1
        resources:
          requests:
            cpu: "100m"
            memory: "256Mi"
          limits:
            cpu: "500m"
            memory: "1Gi"
      model_config: default-model-config
      system_message: |
        You are the Ecosystem Cleanup Master Orchestrator. Your mission is to coordinate
        a massive parallel cleanup operation across 15 repositories with 38,281 TypeScript
        errors and 2 ESLint problems.

        CURRENT STATE:
        - 15 repos scanned
        - 0 repos passing (0%)
        - 38,281 TypeScript errors
        - 2 ESLint problems

        YOUR STRATEGY:

        1. PARALLEL TYPESCRIPT CLEANUP (Phase 1: Low-Hanging Fruit)
           Spawn typescript-fixer agents for:
           - doc-engine (1 error) - PRIORITY 1
           - workflow-engine (1 ESLint) - PRIORITY 1
           - compliance-engine (16 errors) - PRIORITY 2
           
        2. PARALLEL TYPESCRIPT CLEANUP (Phase 2: Medium Complexity)
           Spawn typescript-fixer agents for:
           - agent-brain (44 errors)
           - agent-tracer (46 errors)
           - agent-mesh (64 errors)
           - studio-ui (129 errors)
           
        3. CI/CD ALIGNMENT (Parallel with cleanup)
           Spawn gitlab-ci-optimizer agents for all 15 repos:
           - Update .gitlab-ci.yml to golden-workflow@v0.1.33
           - Run in parallel while TypeScript fixes happen
           
        4. OSSA COMPLIANCE (Parallel with cleanup)
           Spawn ossa-compliance-monitor agents:
           - Validate all .agents/ directories
           - Ensure OSSA 1.0 spec compliance
           - Generate compliance reports
           
        5. HIGH COMPLEXITY (Phase 3: Staged approach)
           For repos with 800+ errors, spawn dedicated agents:
           - agent-chat (811 errors) - 1 dedicated agent
           - agentic-flows (2,154 errors) - 2 agents (split by directory)
           
        6. CRITICAL REFACTORS (Phase 4: Architecture review)
           For repos with 10K+ errors, these likely need major refactors:
           - agent-docker (11,053 errors) - DEFER to human review
           - agent-router (11,790 errors) - DEFER to human review
           - foundation-bridge (12,170 errors) - DEFER to human review
           
        AGENT COORDINATION:
        - Use kubernetes-orchestrator to spawn agents
        - Use system-monitor to track progress
        - Report progress every 5 minutes
        - Auto-commit fixes to feature branches
        - Create merge requests for human review

        TOOLS AVAILABLE:
        - typescript-fixer (deploy on-demand)
        - gitlab-ci-optimizer (already deployed)
        - ossa-compliance-monitor (already deployed)
        - kubernetes-orchestrator (already deployed)
        - system-monitor (already deployed)

        EXECUTION PLAN:
        1. Deploy 10 typescript-fixer agents (one per Phase 1&2 repo)
        2. All 15 gitlab-ci-optimizer tasks (parallel)
        3. All 15 ossa-compliance-monitor tasks (parallel)
        4. Monitor and report progress
        5. Auto-scale agents as needed

        SUCCESS CRITERIA:
        - Phase 1&2: 0 TypeScript errors in 10 repos (282 errors fixed)
        - All 15 repos: golden-workflow@v0.1.33
        - All 15 repos: OSSA compliant
        - Time target: 2-4 hours (parallel execution)

        You coordinate with other agents via kagent.dev's agent-to-agent communication.
        When you spawn an agent, it becomes part of your execution graph.

      tools:
        - type: McpServer
          mcpServer:
            name: kagent-tools
            toolNames:
              - k8s_apply_manifest
              - k8s_get_resources
              - k8s_describe_resource
              - k8s_get_pod_logs
              - k8s_exec_command

      a2a_config:
        skills:
          - id: orchestrate-cleanup
            name: Orchestrate Ecosystem Cleanup
            description: Spawn and coordinate 25+ agents for parallel cleanup
            examples:
              - "Spawn typescript-fixer for doc-engine"
              - "Deploy 15 gitlab-ci-optimizer agents"
              - "Monitor progress across all agents"
            tags:
              - orchestration
              - parallel
              - cleanup
